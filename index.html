<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nova ESL Master</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --primary: #1e3a8a; --bg: #f8fafc; --card: #ffffff; --text: #1e293b; }
        .theme-bg { background-color: var(--bg); color: var(--text); }
        .header-style { background: #fff; border-bottom: 3px solid var(--primary); color: var(--primary); }
        .section-title { color: var(--primary); border-left: 8px solid var(--primary); padding-left: 15px; }
        .affix-tag { background: var(--primary); color: #fff; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: bold; }
        .word-card { background: var(--card); border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); transition: 0.2s; }
        .word-card:active { transform: scale(0.98); background: #eff6ff; }
        .word-text { color: var(--primary); }
        .nav-item { color: var(--primary); font-weight: 900; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="theme-bg min-h-screen">

    <header class="header-style sticky top-0 z-50 p-4 border-b flex justify-between items-center shadow-sm">
        <h1 class="text-xl font-black tracking-tighter" onclick="location.reload()">NOVA MASTER</h1>
        <div id="lesson-id" class="text-xs opacity-60 font-mono italic">LOADING...</div>
    </header>

    <main id="container" class="max-w-2xl mx-auto p-4 pb-24 text-center">
        <div id="loading" class="py-20 opacity-50">åŠ è½½è¯¾ç¨‹æ•°æ®ä¸­...</div>
        <div id="content-area" class="text-left"></div>
    </main>

    <nav class="fixed bottom-0 left-0 right-0 border-t p-3 flex justify-around header-style backdrop-blur-md">
        <button onclick="location.reload()" class="nav-item">åˆ·æ–°è¯¾ç¨‹</button>
        <button onclick="alert('æµ‹è¯•æ¨¡å—å¼€å‘ä¸­...')" class="nav-item opacity-40">æµ‹è¯„</button>
    </nav>

    <script>
        // TTS å‘éŸ³é€»è¾‘
        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.lang = 'en-GB'; 
            msg.rate = 0.85;
            window.speechSynthesis.speak(msg);
        }

        // ä» data.json è·å–æ•°æ®å¹¶æ¸²æŸ“
        async function loadAndRender() {
            try {
                const response = await fetch('data.json');
                if (!response.ok) throw new Error('æ— æ³•è¯»å– data.json');
                const data = await response.json();
                
                renderUI(data);
            } catch (err) {
                document.getElementById('loading').innerHTML = 
                    `<div class="text-red-500">âŒ åŠ è½½å¤±è´¥: ${err.message}<br>è¯·ç¡®ä¿ data.json ä¸ index.html åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œä¸”ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨è®¿é—®ã€‚</div>`;
            }
        }

        function renderUI(lessonData) {
            document.getElementById('loading').classList.add('hidden');
            const container = document.getElementById('content-area');
            document.getElementById('lesson-id').innerText = lessonData.id.toUpperCase();
            
            let html = `<h2 class="text-3xl font-black mt-4 mb-8 section-title animate-fade-in">${lessonData.title}</h2>`;

            lessonData.groups.forEach(group => {
                html += `
                    <section class="mb-10 animate-fade-in">
                        <div class="flex items-baseline gap-2 mb-4">
                            <span class="affix-tag">${group.affix}</span>
                            <span class="text-sm font-bold opacity-70">${group.logic}</span>
                        </div>
                        <div class="grid gap-3">
                            ${group.items.map(item => `
                                <div class="word-card p-4 flex justify-between items-center cursor-pointer" onclick="speak('${item.word}')">
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2">
                                            <span class="text-lg font-bold word-text">${item.word}</span>
                                            <span class="text-[10px] px-1 rounded bg-slate-100 font-mono font-bold">${item.pos}</span>
                                        </div>
                                        <div class="text-xs opacity-50 font-mono font-medium">/${item.phonetic}/</div>
                                        <div class="text-sm mt-1 leading-snug font-medium text-slate-600">${item.meaning}</div>
                                    </div>
                                    <div class="text-xl opacity-20">ğŸ”Š</div>
                                </div>
                            `).join('')}
                        </div>
                    </section>
                `;
            });
            container.innerHTML = html;
        }

        window.onload = loadAndRender;
    </script>
</body>
</html>
